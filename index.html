<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lịch Trở Về Nhà 2026 - 1 Tháng/Lần</title>

    <!-- Favicon con cua -->
    <link rel="icon" href="crab.png" type="image/png">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <style>
        body {
            font-family: 'Segoe UI', Arial, Helvetica, sans-serif;
            background: linear-gradient(135deg, #e0f7fa, #ffffff);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        header {
            background: #e91e63;
            color: white;
            text-align: center;
            padding: 30px 20px;
        }
        h1 {
            margin: 0;
            font-size: 2.2em;
        }
        h1 small {
            display: block;
            font-size: 0.55em;
            margin-top: 8px;
            opacity: 0.9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }
        th {
            background: #e91e63;
            color: white;
            padding: 16px 10px;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        td {
            padding: 14px 10px;
            border-bottom: 1px solid #eee;
            vertical-align: middle;
        }
        tr:nth-child(even) {
            background-color: #fdf2f8;
        }
        tr:hover {
            background-color: #fce4ec;
            transition: 0.3s;
        }
        .note {
            margin: 30px;
            padding: 20px;
            background: #fff3cd;
            border-left: 6px solid #ffc107;
            border-radius: 8px;
            font-size: 0.95em;
        }
        .add-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #e91e63;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 30px;
            line-height: 60px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(233,30,99,0.4);
            cursor: pointer;
            z-index: 100;
            transition: 0.3s;
        }
        .add-btn:hover {
            transform: scale(1.1);
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            table { font-size: 0.85em; }
            th, td { padding: 10px 6px; }
            .note { margin: 20px; padding: 15px; }
            .add-btn { width: 55px; height: 55px; line-height: 55px; font-size: 28px; bottom: 20px; right: 20px; }
        }
        @media (max-width: 480px) {
            table { display: block; overflow-x: auto; white-space: nowrap; }
            th, td { min-width: 100px; }
        }
        @media print {
            body { background: white; }
            .add-btn, header { display: none; }
            .container { box-shadow: none; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>LỊCH TRỞ VỀ NHÀ NĂM 2026
            <small>1 tháng về 1 lần – cố định cuối tuần</small>
        </h1>
    </header>

    <table id="lichTable">
        <thead>
            <tr>
                <th>Tháng</th>
                <th>Ngày về</th>
                <th>Ngày quay lại</th>
                <th>Phương tiện</th>
                <th>Ghi chú</th>
            </tr>
        </thead>
        <tbody>
            <!-- Dữ liệu sẽ được load từ Firebase -->
        </tbody>
    </table>

    <div class="note">
        <strong>Lưu ý:</strong><br>
        • Lịch được lấy tự động từ cơ sở dữ liệu, bạn có thể thêm/sửa trực tiếp bằng nút “+” ở góc dưới.<br>
        • In trang này ra giấy để dán tủ lạnh hoặc lưu PDF đều rất đẹp!<br>
        • Dữ liệu được đồng bộ realtime – mở trên nhiều thiết bị cũng thấy cùng một lịch.
    </div>
</div>

<!-- Nút thêm chuyến mới -->
<div class="add-btn" onclick="openAddForm()">+</div>

<script>
  // ================== CẤU HÌNH FIREBASE CỦA BẠN ==================
  const firebaseConfig = {
    databaseURL: "https://project-doidoi-default-rtdb.asia-southeast1.firebasedatabase.app/"
  };

  // Khởi tạo Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const lichRef = db.ref("lich2026"); // bạn có thể đổi tên node nếu muốn

  // Load dữ liệu và hiển thị
  function renderTable(snapshot) {
    const tbody = document.querySelector("#lichTable tbody");
    tbody.innerHTML = ""; // xóa cũ

    const data = snapshot.val();
    if (!data) {
      tbody.innerHTML = `<tr><td colspan="5">Chưa có dữ liệu. Hãy thêm chuyến đầu tiên!</td></tr>`;
      return;
    }

    // Sắp xếp theo tháng (nếu key là số tháng)
    Object.keys(data).sort((a,b) => a - b).forEach(key => {
      const item = data[key];
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><strong>${item.thang || ''}</strong></td>
        <td>${item.ngayVe || ''}</td>
        <td>${item.ngayQuay || ''}</td>
        <td>${item.phuongTien || ''}</td>
        <td>${item.ghiChu || ''}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Lắng nghe thay đổi realtime
  lichRef.on("value", renderTable);

  // ================== FORM THÊM MỚI ==================
  function openAddForm() {
    const thang = prompt("Tháng (ví dụ: Tháng 1/2026):");
    if (!thang) return;

    const ngayVe = prompt("Ngày về (ví dụ: Thứ 6, 23/01/2026):");
    const ngayQuay = prompt("Ngày quay lại:");
    const phuongTien = prompt("Phương tiện (Xe khách / Máy bay...):", "Xe khách");
    const ghiChu = prompt("Ghi chú (có thể để trống):", "");

    if (ngayVe && ngayQuay) {
      // Lấy số tháng làm key để dễ sắp xếp
      const monthNum = thang.match(/\d+/) ? thang.match(/\d+/)[0].padStart(2, '0') : Date.now();
      const newRef = lichRef.push();
      newRef.set({
        thang: thang.trim(),
        ngayVe: ngayVe.trim(),
        ngayQuay: ngayQuay.trim(),
        phuongTien: phuongTien.trim(),
        ghiChu: ghiChu.trim()
      }).then(() => alert("Đã thêm thành công!"))
       .catch(err => alert("Lỗi: " + err.message));
    }
  }

  // Load lần đầu
  lichRef.once("value").then(renderTable);
</script>

</body>
</html>
